# 双端链表
链表作为数组之外的一种常用序列抽象，是大多数高级语言的基本数据类型，因为C语言本身不支持链表类型，大部分C程序都会自己实现一种链表类型，Redis也不例外——实现了一个双端链表结构。

## 双端链表的应用 
### 实现Redis的列表类型
1.  双端链表
2.  压缩列表

因为双端链表占用的内存比压缩列表要多， 所以当创建新的列表键时， 列表会优先考虑使用压缩列表作为底层实现， 并且在有需要的时候， 才从压缩列表实现转换到双端链表实现。

### Redis自身功能的构建
除了实现列表类型以外， 双端链表还被很多 Redis 内部模块所应用:
1.  事务模块使用双端链表依序保存输入的命令
2.  服务器模块使用双端链表来保存多个客户端
3.  订阅/发送模块使用双端链表来保存订阅模式的多个客户端
4.  事件模块使用双端链表来保存时间事件（time event）

## 双端链表的实现
双端链表的实现由 listNode 和 list 两个数据结构构成
### 双端链表节点listNode:
1.  listNode *prev // 前驱节点
2.  listNode *next // 后驱节点
3.  *value // 值，对类型不做限制

### 双端链接list:
1.  listNode *head // 表头指针
2.  listNode *tail // 表尾指针
3.  unsigned long len // 节点数量
4.  void *(*dup)(void *ptr) // 复制函数
5.  void (*free)(void *ptr) // 释放函数
6.  int (*match)(void *ptr, void *key) // 对比函数

## 特性总结
1.  双端: 链表节点带有prev和next指针，获取某个节点的前置节点和后置节点的复杂度都是O(1)
2.  无环: 表头节点的prev指针和表尾节点的next指针都是指向NULL,对链表的访问以NULL为终点
3.  带表头指针和表尾指针: 通过list结构的head指针和tail指针，程序获取链表的表头节点和表尾节点的复杂度为O(1)
4.  带链表长度计数器: 使用list结构的len属性来记录链表节点数，获取节点数时间复杂度为O(1)
5.  多态: 链表节点使用*void指针来保存节点值，可用list结构的三个函数来对节点值进行操作
